---
title: "Final Report — Personality × Drug Use"
author: "Maryam Khalid, Sijda Ahmed, Ruicheng yang, Xiling Wang, Haixin Jin"
date: "Fall 2025"
output:
  html_document:
    toc: true
    toc_depth: 3
    toc_float: true
    number_sections: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  message = FALSE,
  warning = FALSE,
  fig.width = 8,
  fig.height = 5,
  fig.path = "figs/"
)

library(tidyverse)
library(janitor)
library(broom)
library(knitr)
library(kableExtra)
library(purrr)

data <- read_csv("data/cleaned_drug_data.csv")

# Add grouped drug variables
make_status <- function(x) ifelse(x > 0, "User", "Non-User")

traits <- c("Nscore","Escore","Oscore","Ascore","Cscore")

data <- data %>%
  mutate(
    stim_group = Coke + Meth,
    highrisk = Heroin + Crack + VSA,
    psych = LSD + Mushrooms + Ketamine + Ecstasy + Legalh
  )
```

# Introduction

Substance use behaviors reflect a complex interaction between psychological traits, sociocultural context, and demographic background. Personality psychology provides a valuable lens for understanding why some individuals may be more likely to experiment with, regularly use, or avoid psychoactive substances. This project investigates how the **Big Five personality traits**—Neuroticism, Extraversion, Openness, Agreeableness, and Conscientiousness—relate to both **the likelihood of drug use** and **frequency of use** across multiple classes of substances.

We use the Fehrman et al. (2015) dataset, consisting of 1,876 respondents who reported personality scores, sociodemographic variables (education, country), and frequency-of-use measures for 18 substances. Our goals were to:

- Clean and restructure the dataset into a modern tidy format  
- Visualize patterns of demographic and personality variation  
- Conduct inferential analyses linking personality to drug-use behaviors  
- Examine consistency of findings across drug categories  
- Interpret results in the context of existing psychological literature  

---

# Dataset Overview

The raw dataset included personality traits (via IPIP inventory), demographic variables, and self-reported usage frequencies for substances including cannabis, nicotine, amphetamines, benzodiazepines, stimulants, psychedelics, and more.

Key steps from data cleaning (see *dataset.html* for full workflow):

- Converted categorical frequency scores into numeric use indicators  
- Standardized education and country labels  
- Created grouped drug categories:
  - **Stimulants:** cocaine + methamphetamine  
  - **High-risk drugs:** heroin + crack cocaine + volatile substance abuse  
  - **Psychedelics:** LSD, mushrooms, ketamine, ecstasy, legal highs  
- Removed unusable or missing entries and validated data structure  

Cleaned N = 1,876.

---

# Exploratory Data Analysis

3.1 Trait Distributions

```{r}
data %>%
pivot_longer(cols = Nscore:Cscore, names_to = "trait", values_to = "value") %>%
ggplot(aes(value, fill = trait)) +
geom_histogram(alpha = 0.65, bins = 30) +
facet_wrap(~trait, scales = "free") +
theme_minimal() +
labs(title="Distribution of Big Five Personality Traits")


```

3.2 Drug Usage Prevalence
```{r}
usage <- data %>%
select(Cannabis, Nicotine, Amphet, Benzos, stim_group, highrisk, psych) %>%
summarize(across(everything(), ~mean(.x > 0)*100)) %>%
pivot_longer(everything(), names_to="drug", values_to="percent")

usage %>%
ggplot(aes(reorder(drug, percent), percent)) +
geom_col(fill="#a78bfa") +
coord_flip() +
theme_minimal() +
labs(title="Percent of Participants Reporting Any Use", x="", y="% Users")
```


3.3 Cannabis Usage by Education
```{r}
data %>%
mutate(status = make_status(Cannabis)) %>%
ggplot(aes(Education, fill = status)) +
geom_bar(position="fill") +
coord_flip() +
labs(title="Cannabis Use by Education Level", y="Proportion")

```

3.4 Psychedelic Trait Profiles
```{r}
data %>%
mutate(status = make_status(psych)) %>%
pivot_longer(traits, names_to="trait", values_to="value") %>%
ggplot(aes(trait, value, fill=status)) +
geom_boxplot() +
theme_minimal() +
labs(title="Trait Distributions for Psychedelic Users vs Non-Users")

```


Full analysis pipeline preserved from drug_consumption_analysis.Rmd

# Inferential Methods
For each drug/drug category, we conducted:
1. Chi-square tests: Education x Drug Use, Country x Drug Use
2. ANOVA: trait differences between users and non-users
3. Correlations: trait x use frequency

Helper functions:
```{r}
chi_wrapper <- function(var){
  list(
    edu = chisq.test(table(data[[var]] > 0, data$Education)),
    country = chisq.test(table(data[[var]] > 0, data$Country))
  )
}

anova_wrapper <- function(var){
  d <- data %>% mutate(status = make_status(.data[[var]]))
  map_df(traits, function(tr){
    model <- aov(as.formula(paste0(tr," ~ status")), data=d)
    tidy(model) %>% filter(term=="status") %>% mutate(trait=tr)
  })
}

corr_wrapper <- function(var){
  map_df(traits, function(tr){
    ct <- cor.test(data[[tr]], data[[var]])
    tibble(trait=tr, correlation=ct$estimate, p=ct$p.value)
  })
}
```

# Results
5.1 Cannabis Results

```{r}
chi_can <- chi_wrapper("Cannabis")
anova_can <- anova_wrapper("Cannabis")
corr_can <- corr_wrapper("Cannabis")

anova_can %>% kable() %>% kable_styling()
corr_can %>% kable() %>% kable_styling()

```


5.2 Nicotine Results
```{r}
chi_nic <- chi_wrapper("Nicotine")
anova_nic <- anova_wrapper("Nicotine")
corr_nic <- corr_wrapper("Nicotine")

anova_nic %>% kable() %>% kable_styling()
corr_nic %>% kable() %>% kable_styling()

```


5.3 Amphetamine Results
```{r}
chi_amp <- chi_wrapper("Amphet")
anova_amp <- anova_wrapper("Amphet")
corr_amp <- corr_wrapper("Amphet")

anova_amp %>% kable() %>% kable_styling()
corr_amp %>% kable() %>% kable_styling()

```


5.4 Benzodiazepine Results
```{r}
anova_ben <- anova_wrapper("Benzos")
corr_ben <- corr_wrapper("Benzos")

anova_ben %>% kable() %>% kable_styling()
corr_ben %>% kable() %>% kable_styling()

```


5.5 Stimulant (Cocaina + Meth) Results
```{r}
anova_stim <- anova_wrapper("stim_group")
corr_stim <- corr_wrapper("stim_group")

anova_stim %>% kable() %>% kable_styling()
corr_stim %>% kable() %>% kable_styling()

```


5.6 High-Risk Drug Results
```{r}
anova_hr <- anova_wrapper("highrisk")
corr_hr <- corr_wrapper("highrisk")

anova_hr %>% kable() %>% kable_styling()
corr_hr %>% kable() %>% kable_styling()


```

5.7 Psychedelic Results
```{r}
anova_psy <- anova_wrapper("psych")
corr_psy <- corr_wrapper("psych")

anova_psy %>% kable() %>% kable_styling()
corr_psy %>% kable() %>% kable_styling()
```


---

# Discussion
Across all drug categories, several patterns remained remarkably stable:

### **Openness was consistently higher among users.**  
This aligns with literature describing high-Openness individuals as novelty-seeking and more willing to experiment with altered states of consciousness (Terracciano et al., 2008).

### **Conscientiousness was consistently lower among users.**  
Low Conscientiousness relates to impulsivity, weaker behavioral inhibition, and risk-taking tendencies—widely documented predictors of substance use initiation and maintenance.

### **Neuroticism was elevated for nicotine, benzodiazepines, stimulants, and high-risk drugs.**  
This matches frameworks suggesting emotional instability increases susceptibility to using substances for coping or affect regulation.

### **Agreeableness was lower among users of almost all drug categories.**  
Low Agreeableness is associated with defiance of norms, reduced compliance, and antagonistic traits.

### **Sociodemographic effects were strong.**  
Education and country significantly predicted user status for every drug category. North American and UK respondents showed the highest prevalence for nearly all substances.

### **Alignment with Prior Research**  
Our findings strongly align with:
- Terracciano et al. (2008) showing C ↓, A ↓, N ↑ in substance users
- “Big Five and Illegal Drug Use” (Allen et al. 2015): Openness ↑, Conscientiousness ↓
- “Personality Development & Substance Use” (Littlefield & Sher): Neuroticism-linked risk
- “Nonmedical Cognitive Enhancers & Personality” suggesting O ↑ and C ↓ in misuse contexts

Our results reinforce that personality traits can provide a stable psychological structure underlying substance-use behaviors, while sociodemographic context modulates access, norms, and prevalence.

---

# Limitations

- Cross-sectional dataset cannot infer causality  
- Self-reported drug use prone to recall and social-desirability bias  
- Frequency scores are ordinal approximations  
- Cultural factors cannot be fully captured by coarse country categories  
- No adjustment for multiple testing (large number of ANOVAs)  

---

# Conclusion

The interplay between personality and drug use is systematic, robust, and highly replicable. Openness strongly predicted experimentation across nearly all substances, while Conscientiousness and Agreeableness consistently protected against use. Neuroticism was a key marker for substances associated with coping-motivated behavior.

Together, personality traits and sociodemographic context offer a powerful framework for understanding individual differences in psychoactive substance use.

---

# Appendix: Reproducible Code

Full analysis scripts are available in:

- **dataset.html** — data cleaning  
- **visualization.html** — exploratory graphics  
- **inferential_analyses.html** — full statistical results  

